<!--
Copyright 2024 Deutsche Telekom IT GmbH

SPDX-License-Identifier: Apache-2.0
-->

# Horizon-Polaris Helm chart

![Version: 1.0.0](https://img.shields.io/badge/Version-1.0.0-informational?style=flat-square)  

Helm chart for deploying Horizon's [Comet](https://github.com/telekom/pubsub-horizon-polaris) component.

## Values

| Key                              | Type   | Default                                                                                                                                                                      | Description                                                                                                                                                                          |
|----------------------------------|--------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| affinity                         | object | `{"enabled":true}`                                                                                                                                                           | Affinity: Configures settings related to affinity.                                                                                                                                   |
| common.cluster                   | string | `"cluster"`                                                                                                                                                                  | Cluster: The name of the cluster where the resource is running.                                                                                                                      |
| common.domain                    | string | `"example.domain.com"`                                                                                                                                                       | Domain: The domain under which the resource is hosted.                                                                                                                               |
| common.imagePullSecrets          | list   | `[]`                                                                                                                                                                         | ImagePullSecrets: Defines image pull secrets for different clusters.                                                                                                                 |
| common.metadata.environment      | string | `"default"`                                                                                                                                                                  | Main product: The main product to which the resource belongs. The product is identified as Horizon.                                                                                  |
| common.subProduct                | string | `"polaris"`                                                                                                                                                                  | Sub product: Subproduct of the main product Horizon. In this helm chart the subproduct is Polaris.                                                                                   |
| common.team                      | string | `"horizon-pubsub"`                                                                                                                                                           | Team: The team for managing and developing Horizon.                                                                                                                                  |
| commonHorizon.defaultEnvironment | string | `"default"`                                                                                                                                                                  | Environment: Sets the default environment.                                                                                                                                           |
| commonHorizon.informer           | object | `{"namespace":"default"}`                                                                                                                                                    | Informer: Specifies namespace for the informer.                                                                                                                                      |
| commonHorizon.jmxRemote          | object | `{"enabled":false}`                                                                                                                                                          | JMX: Enables or disables JMX remote configuration.                                                                                                                                   |
| commonHorizon.kafka              | object | `{"acks":1,"brokers":"kafka:9092","compression":{"enabled":true,"type":"snappy"},"groupId":"polaris","lingerMs":5}`                                                          | Kafka configuration: Specifies Kafka broker details for common Horizon settings, including broker addresses, groupId, linger time, acknowledgment settings, and compression options. |
| commonHorizon.logLevel           | string | `"WARN"`                                                                                                                                                                     | Logging: Sets the log level for general logging.                                                                                                                                     |
| commonHorizon.tracing            | object | `{"jaegerCollectorBaseUrl":"http://localhost:14268","samplerProbability":"1.0"}`                                                                                             | Tracing: Configures tracing settings, including Jaeger collector base URL, and sampler probability.                                                                                  |
| containerSecurityContext         | object | `{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"privileged":false,"readOnlyRootFilesystem":true,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000}` | ContainerSecurityContext: Security context set for the container.                                                                                                                    |
| image                            | object | `{"name":"polaris","organization":"internal/example/horizon","pullPolicy":"IfNotPresent","repository":"example.devops.company.de","tag":"develop"}`                          | Image configuration for "polaris" deployment: Specifies the image details such as repository, organization, name, tag, and pull policy.                                              |
| ingress                          | object | `{"annotations":{},"hostname":null}`                                                                                                                                         | Ingress: Sets the hostname and annotations.                                                                                                                                          |
| livenessProbe                    | object | `{"failureThreshold":8,"initialDelaySeconds":20,"periodSeconds":10}`                                                                                                         | LivenessProbe: Kubernetes Liveness Probe configuration.                                                                                                                              |
| monitoring                       | object | `{"serviceMonitor":{"enabled":true,"selector":"selector"}}`                                                                                                                  | Monitoring: Service monitor configuration.                                                                                                                                           |
| podSecurityContext               | object | `{"fsGroup":1000,"supplementalGroups":[1000]}`                                                                                                                               | PodSecurityContext: Security context set for the pod.                                                                                                                                |
| polaris.cache                    | object | `{"serviceDNS":"cache"}`                                                                                                                                                     | Cache configuration: Define cache service DNS.                                                                                                                                       |
| polaris.informer                 | object | `{"pods":{"namespace":"default"}}`                                                                                                                                           | Informer namespace: Configuration for the informer, including default namespace.                                                                                                     |
| polaris.iris                     | object | `{"clientId":"clientId","clientSecret":"secret","tokenEndpoint":"irisUrl"}`                                                                                                  | Iris configuration: Authentication details for Iris, including the token endpoint, clientId, and client secret.                                                                      |
| polaris.maxConnections           | int    | `100`                                                                                                                                                                        | Max connections: Maximum allowed connections.                                                                                                                                        |
| polaris.maxTimeout               | int    | `30000`                                                                                                                                                                      | Max timeout: Maximum timeout duration.                                                                                                                                               |
| polaris.mongo                    | object | `{"clientId":"polaris","url":"mongodbUrl"}`                                                                                                                                  | Mongo configuration: Set clientId and mongo URL for mongo configuration.                                                                                                             |
| polaris.offsetMins               | object | `{"deliveringStates":15}`                                                                                                                                                    | OffsetMins: Offset duration to adjust the time before considering states as delivered.                                                                                               |
| polaris.picking                  | object | `{"timeoutMs":5000}`                                                                                                                                                         | Picking: Timeout duration for the picking process.                                                                                                                                   |
| polaris.polling                  | object | `{"batchSize":10,"intervalMs":30000}`                                                                                                                                        | Polling: Configuration for polling mechanism.                                                                                                                                        |
| polaris.republish                | object | `{"batchSize":100,"threadpool":{"coreSize":50,"maxSize":50,"queueCapacity":50},"timeoutMs":5000}`                                                                            | Republish: Configuration for republishing mechanism.                                                                                                                                 |
| polaris.request                  | object | `{"cooldownResetMins":90,"delayMins":5,"scheduledThreadpool":{"size":50},"successfulStatusCodes":"200,201,202,204"}`                                                             | Request: Configuration related to handling requests.                                                                                                                                 |
| polaris.subscriptionCheck        | object | `{"threadpool":{"coreSize":50,"maxSize":50,"queueCapacity":50}}`                                                                                                             | SubscriptionCheck: Configuration related to subscription checking.                                                                                                                   |
| rbac                             | object | `{"create":"true","serviceAccountName":null}`                                                                                                                                | RBAC: Configures settings related to RBAC (Role-Based Access Control).                                                                                                               |
| readinessProbe                   | object | `{"failureThreshold":8,"initialDelaySeconds":20,"periodSeconds":10}`                                                                                                         | ReadinessProbe: Kubernetes Readiness Probe configuration.                                                                                                                            |
| replicas                         | int    | `1`                                                                                                                                                                          | Deployment replicas: Sets the number of replicas for the deployment.                                                                                                                 |
| resources                        | object | `{"limits":{"cpu":1,"memory":"1Gi"},"requests":{"cpu":"50m","memory":"200Mi"}}`                                                                                              | Resources: Resource limits and requests.                                                                                                                                             |
| startupProbe                     | object | `{"enabled":false,"failureThreshold":75,"initialDelaySeconds":0,"periodSeconds":1}`                                                                                          | StartupProbe: Kubernetes Startup Probe configuration.                                                                                                                                |
| strategy                         | object | `{}`                                                                                                                                                                         | Deployment strategy: Sets the deployment strategy for the deployment.                                                                                                                |

