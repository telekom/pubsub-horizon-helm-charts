<!--
Copyright 2024 Deutsche Telekom IT GmbH

SPDX-License-Identifier: Apache-2.0
-->

# Horizon-Starlight Helm chart

![Version: 1.0.0](https://img.shields.io/badge/Version-1.0.0-informational?style=flat-square)  

Helm chart for deploying Horizon's [Starlight](https://github.com/telekom/pubsub-horizon-starlight) component.

## Values

| Key                               | Type   | Default                                                                                                                                                                            | Description                                                                                                                                                                                                 |
|-----------------------------------|--------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| affinity                          | object | `{"enabled":true}`                                                                                                                                                                 | Affinity: Configures settings related to affinity.                                                                                                                                                          |
| common.cluster                    | string | `"cluster"`                                                                                                                                                                        | Cluster: The name of the cluster where the resource is running.                                                                                                                                             |
| common.domain                     | string | `"example.domain.com"`                                                                                                                                                             | Domain: The domain under which the resource is hosted.                                                                                                                                                      |
| common.imagePullSecrets           | list   | `[]`                                                                                                                                                                               | ImagePullSecrets: Defines image pull secrets for different clusters.                                                                                                                                        |
| common.metadata.environment       | string | `"default"`                                                                                                                                                                        | Metadata environment: The environment in which the resource is deployed.                                                                                                                                    |
| common.product                    | string | `"horizon"`                                                                                                                                                                        | Main product: The main product to which the resource belongs. The product is identified as Horizon.                                                                                                         |
| common.subProduct                 | string | `"starlight"`                                                                                                                                                                      | Sub product: Subproduct of the main product Horizon. In this helm chart the subproduct is Starlight.                                                                                                        |
| common.team                       | string | `"horizon-pubsub"`                                                                                                                                                                 | Team: The team for managing and developing Horizon.                                                                                                                                                         |
| commonHorizon.defaultEnvironment  | string | `"default"`                                                                                                                                                                        | Environment: Sets the default environment.                                                                                                                                                                  |
| commonHorizon.informer            | object | `{"namespace":"default"}`                                                                                                                                                          | Informer: Specifies namespace for the informer.                                                                                                                                                             |
| commonHorizon.issuerUrl           | string | `"issuerUrl"`                                                                                                                                                                      | IssuerUrl: Sets the issuerUrl.                                                                                                                                                                              |
| commonHorizon.jmxRemote           | object | `{"enabled":false}`                                                                                                                                                                | JMX: Enables or disables JMX remote configuration.                                                                                                                                                          |
| commonHorizon.kafka               | object | `{"acks":1,"brokers":"kafka:9092","compression":{"enabled":true,"type":"snappy"},"groupId":"starlight","lingerMs":5}`                                                              | Kafka configuration: Specifies Kafka broker details for common Horizon settings, including broker addresses, groupId, linger time, acknowledgment settings, and compression options.                        |
| commonHorizon.logLevel            | string | `"WARN"`                                                                                                                                                                           | Logging: Sets the log level for general logging.                                                                                                                                                            |
| commonHorizon.publishingTimeoutMs | int    | `45000`                                                                                                                                                                            | Publishing timeout: Sets the timeout duration (in milliseconds) for the publishing process.                                                                                                                 |
| commonHorizon.tracing             | object | `{"debugEnabled":false,"jaegerCollectorBaseUrl":"http://localhost:14268","samplerProbability":"1.0"}`                                                                              | Tracing: Configures tracing settings, including debug mode, Jaeger collector base URL, and sampler probability.                                                                                             |
| commonHorizon.victorialog         | object | `{"batchSize":500,"clientId":"starlight","collectorUrl":"http://localhost:8428","countEventsInterval":60000,"enabled":false,"observationFlushInterval":60000,"samplingRate":0.05}` | Metrics - Victorialog: Controls the collection of metrics using Victorialog, specifying parameters like collector URL, clientId, batchsize, observationFlushInterval, countEventsInterval and samplingRate. |
| containerSecurityContext          | object | `{"allowPrivilegeEscalation":false,"capabilities":{"drop":["ALL"]},"privileged":false,"readOnlyRootFilesystem":true,"runAsGroup":1000,"runAsNonRoot":true,"runAsUser":1000}`       | ContainerSecurityContext: Security context set for the container.                                                                                                                                           |
| image                             | object | `{"name":"starlight","organization":"internal/example/horizon","pullPolicy":"IfNotPresent","repository":"example.devops.company.de","tag":"develop"}`                              | Image configuration for "starlight" deployment: Specifies the image details such as repository, organization, name, tag, and pull policy.                                                                   |
| ingress                           | object | `{"annotations":{},"enabled":false,"hostname":null,"isCaaS":false}`                                                                                                                | Ingress: Specifies whether ingress is enabled, sets the hostname, annotations, and indicates whether it is designed for CaaS (Container as a Service).                                                      |
| livenessProbe                     | object | `{"failureThreshold":8,"initialDelaySeconds":20,"periodSeconds":10}`                                                                                                               | LivenessProbe: Kubernetes Liveness Probe configuration.                                                                                                                                                     |
| monitoring                        | object | `{"serviceMonitor":{"enabled":true,"selector":"selector"}}`                                                                                                                        | Monitoring: ServiceMonitor configuration.                                                                                                                                                                   |
| podSecurityContext                | object | `{"fsGroup":1000,"supplementalGroups":[1000]}`                                                                                                                                     | PodSecurityContext: Security context set for the pod.                                                                                                                                                       |
| rbac                              | object | `{"create":"true","serviceAccountName":null}`                                                                                                                                      | RBAC: Configures settings related to RBAC (Role-Based Access Control).                                                                                                                                      |
| readinessProbe                    | object | `{"failureThreshold":8,"initialDelaySeconds":20,"periodSeconds":10}`                                                                                                               | ReadinessProbe: Kubernetes Readiness Probe configuration.                                                                                                                                                   |
| replicas                          | int    | `1`                                                                                                                                                                                | Deployment replicas: Sets the number of replicas for the deployment.                                                                                                                                        |
| resources                         | object | `{"limits":{"cpu":1,"memory":"500Mi"},"requests":{"cpu":"50m","memory":"200Mi"}}`                                                                                                  | Resources: Resource limits and requests.                                                                                                                                                                    |
| starlight.eniapi                  | object | `{"baseurl":"localhost:9433"}`                                                                                                                                                     | Eniapi: Configuration for internal eniapi including the base URL.                                                                                                                                           |
| starlight.features                | object | `{"customPublishingTopics":[],"publisherCheck":true,"schemaValidation":true}`                                                                                                      | Features: Configure features such as publisherCheck, schemaValidation, and customPublishingTopics.                                                                                                          |
| starlight.oidc                    | object | `{"clientId":"clientId","clientSecret":"secret","issuerUrl":"irisUrl"}`                                                                                                            | OIDC: Configuration for authentication.                                                                                                                                                                     |
| startupProbe                      | object | `{"enabled":false,"failureThreshold":75,"initialDelaySeconds":0,"periodSeconds":1}`                                                                                                | StartupProbe: Kubernetes Startup Probe configuration.                                                                                                                                                       |

